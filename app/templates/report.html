{% extends "base.html" %}

{% block title %}
{{report.get_report_title()}}
{% endblock %}

{% block filters %}
<form>
  <!-- Start Date -->
  <div class="form-row mb-3">
    <div class="input-group">
      <div class="input-group-prepend">
        <span class="input-group-text" id="inputGroupPrepend">Start</span>
      </div>
      <input type="date" name="start" value="{{report.start_formatted()}}" class="form-control">
    </div>
  </div>
  <!-- End Date -->
  <div class="form-row mb-3">
    <div class="input-group">
      <div class="input-group-prepend">
        <span class="input-group-text" id="inputGroupPrepend">End</span>
      </div>
      <input type="date" name="end" value="{{report.end_formatted()}}" class="form-control">
    </div>
  </div>
  <!-- Name -->
  <div class="form-row mb-3">
    <div class="input-group">
      <div class="input-group-prepend">
        <label class="input-group-text">Name</label>
      </div>
      <select class="custom-select" name="name">
        {% for name in names %}
        {% if name == report.name %}
        <option selected name="name" value="{{name}}">{{name}}</option>
        {% else %}
        <option name="name" value="{{name}}">{{name}}</option>
        {% endif %}
        {% endfor %}
      </select>
    </div>
  </div>
  <!-- Platform -->
  <div class="form-row mb-3">
    <div class="input-group">
      <div class="input-group-prepend">
        <label class="input-group-text">Platform</label>
      </div>
      <select class="custom-select" name="platform">
        {% for platform in platforms %}
        {% if platform == report.platform %}
        <option selected value="{{platform}}">{{platform}}</option>
        {% else %}
        <option value="{{platform}}">{{platform}}</option>
        {% endif %}
        {% endfor %}
      </select>
    </div>
  </div>
  <!-- Submit Button -->
  <div class="form-row mb-3 float-right">
    <button type="submit" class="btn btn-primary">Submit</button>
  </div>
</form>
{% endblock %}

{% block content %}
<table class="table table-striped table-light table-hover sortable">
  <thead class="thead-light">
    <th scope="col">{{report.date_range()}}</th>
    <th scope="col">Repo</th>
    <th scope="col">Views</th>
    <th scope="col">Views (unique)</th>
    <th scope="col">Clones</th>
    <th scope="col">Clones (unique)</th>
  </thead>
  <tbody>
    {% for insight in report.insights %}
    <tr>
      <th scope="row"><a href="{{insight.repo.slugged_full_name()}}?d=c">{{insight.repo.full_name()}} </a></th>
      <td><a href="{{insight.repo.url()}}" target="blank">{{insight.repo.repo}}</a></td>
      <td>{{insight.view_count}}</td>
      <td>{{insight.view_uniques}}</td>
      <td>{{insight.clone_count}}</td>
      <td>{{insight.clone_uniques}}</td>
    </tr>
    {% endfor %}
  </tbody>
  <tfoot>
    <tr style="font-weight:bold;">
      <th scope="row">Total</th>
      <td></td>
      <td>{{report.view_count_sum}}</td>
      <td>{{report.view_uniques_sum}}</td>
      <td>{{report.clone_count_sum}}</td>
      <td>{{report.clone_uniques_sum}}</td>
    </tr>
  </tfoot>
</table>
{% endblock %}
