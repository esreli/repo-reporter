<html>
<head>
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
</head>
<body>
  <div class="container">
    <div class="page-header">
      <h1>Repo<span style="color:DimGray">rter</span></h1>
    </div>
    <form>
      <div class="form-row">
        <!-- Start Date -->
        <div class="col-md-4 mb-3">
          <div class="input-group">
            <div class="input-group-prepend">
              <span class="input-group-text" id="inputGroupPrepend">Start</span>
            </div>
            <input type="date" name="start" value="{{report.start_formatted()}}" class="form-control">
          </div>
        </div>
        <!-- End Date -->
        <div class="col-md-4 mb-3">
          <div class="input-group">
            <div class="input-group-prepend">
              <span class="input-group-text" id="inputGroupPrepend">End</span>
            </div>
            <input type="date" name="end" value="{{report.end_formatted()}}" class="form-control">
          </div>
        </div>
      </div>
      <div class="form-row">
        <!-- Name -->
        <div class="col-md-4 mb-3">
          <div class="input-group">
            <div class="input-group-prepend">
              <label class="input-group-text">Name</label>
            </div>
            <select class="custom-select" name="name">
              {% for name in names %}
              {% if name == report.name %}
              <option selected name="name" value="{{name}}">{{name}}</option>
              {% else %}
              <option name="name" value="{{name}}">{{name}}</option>
              {% endif %}
              {% endfor %}
            </select>
          </div>
        </div>
        <!-- Platform -->
        <div class="col-md-4 mb-3">
          <div class="input-group mb-3">
            <div class="input-group-prepend">
              <label class="input-group-text">Platform</label>
            </div>
            <select class="custom-select" name="platform">
              {% for platform in platforms %}
              {% if platform == report.platform %}
              <option selected value="{{platform}}">{{platform}}</option>
              {% else %}
              <option value="{{platform}}">{{platform}}</option>
              {% endif %}
              {% endfor %}
            </select>
          </div>
        </div>
        <div class="col-md-2 mb-3">
          <button type="submit" class="btn btn-primary">Submit</button>
        </div>
      </div>
    </form>
    <!-- Results -->
      <table class="table table-striped table-light table-hover">
        <thead class="thead-light">
          <th scope="col">{{report.date_range()}}</th>
          <th scope="col">Views</th>
          <th scope="col">Views (unique)</th>
          <th scope="col">Clones</th>
          <th scope="col">Clones (unique)</th>
        </thead>
        <tbody>
          {% for insight in report.insights %}
          <tr>
            <th scope="row">{{insight.repo.full_name()}} <a href="{{insight.repo.url()}}">(repo)</a></th>
            <td>{{insight.view_count}}</td>
            <td>{{insight.view_uniques}}</td>
            <td>{{insight.clone_count}}</td>
            <td>{{insight.clone_uniques}}</td>
          </tr>
          {% endfor %}
          <tr style="font-weight:bold;">
            <th scope="row">Total</th>
            <td>{{report.view_count_sum}}</td>
            <td>{{report.view_uniques_sum}}</td>
            <td>{{report.clone_count_sum}}</td>
            <td>{{report.clone_uniques_sum}}</td>
          </tr>
        </tbody>
      </table>
      <hr/>
      {% for insight in report.insights %}
      <h3>{{insight.repo.full_name()}}</h3>
        <!-- Referrer -->
      <table class="table table-striped table-light table-hover">
        <thead class="thead-light">
          <th scope="col">Referrer</th>
          <th scope="col">Count (normalized)</th>
          <th scope="col">Unique (normalized)</th>
        </thead>
        <tbody>
          {% for referrer in insight.referrers %}
          <tr>
            <td>{{referrer.referrer}}</td>
            <td>{{referrer.count}}</td>
            <td>{{referrer.uniques}}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
      <!-- Path -->
      <table class="table table-striped table-light table-hover">
        <thead class="thead-light">
          <th scope="col">Path</th>
          <th scope="col">Count (normalized)</th>
          <th scope="col">Unique (normalized)</th>
        </thead>
        <tbody>
          {% for path in insight.paths %}
          <tr>
            <td><a href="{{path.url()}}" target="_blank">{{path.path}}</a></td>
            <td>{{path.count}}</td>
            <td>{{path.uniques}}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
      {% endfor %}
    </div>
</body>
</html>
